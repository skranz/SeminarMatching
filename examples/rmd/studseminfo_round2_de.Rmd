
```{r include=FALSE}
library(rmdtools)
library(SeminarMatching)

setwd("D:/libraries/SeminarMatching/semedit_app/rmd")
db.dir = paste0("../db")
semdb = dbConnect(dbname=paste0(db.dir,"/semDB.sqlite"), drv = SQLite())
seminars = dbGet(semdb,"seminars")


file="studseminfo_round2_de.Rmd"

cat.rmd.params(file)
params = NULL
#cat(paste0(names(res),"=",res, collapse=", "))

today = as.Date(Sys.time())
semester = "SS15"

params = list(
  today = today,
  round1_date = today-1,  
  stud_start_date = today-10,
  round1_done_date = today-1,
  stud.exists = TRUE,
  round2_date = today,
  stud_sems = seminars,
  round2_done_date = today,
  last_latecomer_date = today+5,
  semester = semester
)
copy.into.env(params)
.GlobalEnv$knit_print.Date = function(x,...) {
  restore.point("whisker_print.date")

  format(x, format="%a. %d.%m.%Y")
}
#whisker_print.data.frame = table.knit_print.data.frame

view.rmd(file = file, envir=params,chunks.like.whisker=FALSE)


stop.without.error()
```

<!-- START -->

### Seminarauswahl 2. Runde

#< if NROW(stud_sems)>0
Sie haben bereits einen Platz in folgendem Seminar erhalten:

```{r results = 'asis', echo=FALSE}
cat(
  assigned.sems.table(stud_sems=stud_sems,header = c("Seminar","Dozent"), topic.header = "Thema")
)
```

Falls Sie an zwei Seminaren teilnehmen möchten, können Sie hier noch bis zum Ihre {{round2_date-1}} Präferenzen für Ihr zweites Seminar angeben.
#>

#< if NROW(stud_sems)==0
Sie haben leider in der ersten Runde keinen Seminarplatz erhalten.

Sie können hier noch bis zum {{round2_date-1}} im Reiter `Seminarwahl` Präferenzen für die zweite Vergaberunde angeben.
#>


Wählen Sie bitte aus der Liste aller Seminare diejenigen und nur diejenigen Seminare aus, an denen Sie noch teilnehmen würden, wenn Sie einen Platz erhalten.

Sortieren Sie dann die ausgewählten Seminare gemäß Ihrer Wunschreihenfolge
(bevorzugte Seminare weiter oben) und **speichern Sie dann per Knopfdruck ihre Präferenzen**.


#< note "Details zur Seminarplatzvergabe (2. Runde)"
- In der zweiten Runde werden restliche Seminarplätze vergeben, die in der ersten Runde noch nicht aufgefüllt wurden.

- Eine Teilnahme macht im Prinzip nur Sinn, wenn Sie an 2 Seminaren dieses Semester teilnehmen möchten. Sie können kein besseres Seminar als in der 1. Runde erhalten.

- Sie können so viele Seminare in Ihre Präferenzliste aufnehmen, wie Sie möchten. Sie bekommen in jeder Vergaberunde maximal einen Seminarplatz hieraus zugeteilt.

- Sie sollten alle Seminare und nur diese Seminare aufnehmen, an denen Sie wirklich teilnehmen würden, wenn Sie einen Seminarplatz erhalten.

- Wenn Sie einen Seminarplatz erhalten und später doch nicht teilnehmen, können Sie ggf. einen Malus bei zukünftigen Seminarvergaben erhalten.

- Die Seminarplätze werden gemäß des studentenoptimalen <a href="https://en.wikipedia.org/wiki/Stable_marriage_problem" target="_blank">Gale-Shapley Algorithmus</a> zugeteilt.

- Dies bedeutet, es ist in Ihrem besten Interesse
(eine schwach dominante Strategie) Ihre
Präferenzreihenfolge über die Seminare
wahrheitsgetreu anzugeben.

- Dies ist anders als z. B. bei der Studienplatzvergabe der ZVS, wo es z. B. Sinn machen könnte seine zweite Wahl aus strategischen Gründen auf Platz 1 zu setzen.

- Bei unserem Vergabemechanismus ist für Sie niemals vorteilhaft, Ihre Präferenzen aus strategischen Gründen falsch anzugeben.
#> end note


### Ausgewählten Seminare und Rangfolge (Runde 2)

{{uiOutput("selSemUI")}}

{{actionButton("saveStudprefBtn","Präferenzliste speichern")}}
{{bsAlert("saveStudprefAlert")}}

### Alle angebotenen Seminare

{{uiOutput("allSemUI")}}




